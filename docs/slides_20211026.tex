\include{headers/header.slides}
\include{headers/cmd}
\usepackage{subfig}
\usepackage[style=authoryear]{biblatex}
\usepackage{bm}

\date{\today}
\addbibresource{headers/qcqp.bib}


\begin{document}
\fontsize{9pt}{11}\selectfont
\frame{\titlepage}
\begin{frame}{QCQP}
  Recall QCQP:

  \begin{equation}
    \begin{aligned}
      \mathrm{Maximize}\quad & x^TQx + q^T x                                   \\
      \mathrm{s.t.}  \quad   & x^{T} A_i x  + a_i^Tx   \; (\le, =, \ge) \; b_i \\
                             & 0\le x\le e
    \end{aligned}
  \end{equation}

  \begin{itemize}
    \item \(Q, A_i\) maybe indefinite
  \end{itemize}
\end{frame}
\begin{frame}{Some Convex Relaxations}
  Now assume we are using a suitable relaxation, we choose second-order cones. No SDP, LP is allowed.
  \begin{itemize}
    \item Method 1, \textcolor{red}{(MSC)} Many-small-cones, based on spectral decomposition, then we approximate on 1-D quadratic functions that form the many but smaller (actually 2D) smaller cones
    \item Method 2, scale \(Q, A_i\) to be positive/negative semi-definite, then do convex relaxation based on Cholesky \(Q +\lambda I_n = RR^T\), method 2 is simply,
          \begin{equation}\label{eq:primal.Sigma}
            \begin{aligned}
               & x^T(Q_i+t_i I_n) x+q_i^T x \leqslant b_i+ t_i \cdot s,i= 1,\dots, m \\
               & x^T x= s
            \end{aligned}
          \end{equation}
  \end{itemize}
\end{frame}
\begin{frame}{1. MSC}
  Consider MSC relaxation with spectral decomposition, \(Q =V_0 \diag (\lambda_0) V_0^T, A_i = V_i \diag (\lambda_i) V_i^T\)
  \begin{equation}\label{eq.rel.msc}
    \begin{aligned}
      \model{MSC} \quad \mathrm{Maximize: }\quad & y_0 ^T\lambda_0                                      \\
      \mathrm{s.t.} \quad                        & \textcolor{red}{ V_i^Tx = z_i}           & i=0,...,m \\
                                                 & y_i ^T\lambda_i  + a_i^Tx  \le b_i       & i=1,...,m \\
                                                 & \textcolor{red}{y_i \ge z_i \circ z_i  } & i=0,...,m
    \end{aligned}
  \end{equation}
  Let \(\Omega\) defines the set of second-order cones for \((x, \bm y, \bm z)\)
  \begin{equation}
    \Omega = \left\{ (x,z,y) :  \begin{aligned}
       & V_i^Tx = z_i                       & i=0,...,m \\
       & y_i ^T\lambda_i  + a_i^Tx  \le b_i & i=1,...,m \\
       & y_i \ge z_i \circ z_i              & i=0,...,m \\
    \end{aligned}\right\}
  \end{equation}
\end{frame}
\begin{frame}{Remarks on Convexification}
  \begin{itemize}
    \item Have to place a bound on \(y_i\) or \(s\) to avoid unboundedness, which is the overestimate of norm
    \item Weaker than SDP, but very fast
  \end{itemize}

  Method  1, 2 are actually equivalent in some sense, the nonconvexity moves to \(\|x\|^2= s\), which is the optimization on the \(\mathscr{L}_2\) sphere.

  So we come up with 2 ways to do this,

  \begin{itemize}
    \item 1. A bilinear program using ADMM to produce local solution, \(\|x\|^2 = \max_{\|\xi\| \le \sqrt s} \xi^T x\)
    \item 2. Branch-and-cut using linear relaxation on \(\|x\|^2= s\)
  \end{itemize}
\end{frame}

\begin{frame}{the ADMM approach}
  This allows the augmented Lagrangian function,

  \begin{align*}
    \mathscr L\left(x,y,z,\xi,s,\kappa,\mu\right) & = - y_0 ^T\lambda_0 + \kappa(t-s) + \mu(\xi^Tx - t) + \frac{\rho}{2}(t-s)^2 + \frac{\rho}{2}(\xi^Tx - s)^2
  \end{align*}

  The ADMM iteration,

  \begin{align*}
    (x,y,z,t)^{k+1} & = {\arg\min}_{(x,y,z)\in\Omega, t\ge 0} L\left(x,y,z,\xi^k,s^k,\kappa^k,\mu^k\right)       \\
    (s, \xi)^{k+1}  & = {\arg\min}_{(s, \xi)\in\mathscr{Q}} L\left((x,y,z,t)^{k+1},\xi,s, \kappa^k, \mu^k\right) \\
    \kappa^{k+1}    & = \kappa^k + \rho\left(t^{k+1}-s^{k+1}\right)                                              \\
    \mu^{k+1}       & = \mu^k + \rho\left( \langle\xi^{k+1}, x^{k+1}\rangle - s^{k+1}\right)
  \end{align*}
  where \(\mathscr{Q(\cdot)}\) forms a simple SOCP for \(s, \xi\),
  \begin{equation}
    \mathscr{Q}(x) =\left\{(s,\xi): \|\xi\|^2 \le s\right\}
  \end{equation}
\end{frame}
\begin{frame}{Simple test on ADMM}
  \begin{tabular}{llrrrrrl}
    \toprule
    {} & $n$:$m$:id  & $t$     & best\_bound & best\_obj & relax\_obj & nodes & method    \\
    \midrule
    0  & 5:5:0       & 0.03    & 5.56        & 5.56      & 5.56       & 29.0  & grb       \\
    1  & 5:5:0       & 8.44    & 5.56        & 5.56      & 5.56       & 171.0 & admm\_msc \\
    0  & 50:20:0     & 200.00  & 189.34      & 87.69     & 189.34     & 839.0 & grb       \\
    1  & 50:20:0     & 200.04  & 123.06      & 122.99    & 123.00     & 248.0 & admm\_msc \\
    0  & 50:50:0     & 200.00  & 197.20      & 68.50     & 197.20     & 395.0 & grb       \\
    1  & 50:50:0     & 200.39  & 159.97      & 157.23    & 157.36     & 86.0  & admm\_msc \\
    0  & 100:20:0    & 400.00  & 777.92      & 90.51     & 777.92     & 65.0  & grb       \\
    1  & 100:20:0    & 402.83  & 385.68      & 383.19    & 383.28     & 130.0 & admm\_msc \\
    0  & 100:50:0    & 400.01  & 817.60      & 115.00    & 817.60     & 12.0  & grb       \\
    1  & 100:50:0    & 406.29  & 367.47      & 358.75    & 359.59     & 61.0  & admm\_msc \\
    0  & 200:5:0     & 1000.00 & 3205.11     & 111.11    & 3205.11    & 2.0   & grb       \\
    1  & 200:5:0     & 1002.45 & 519.80      & 519.37    & 519.38     & 375.0 & admm\_msc \\
    0  & 200:20:0    & 1000.01 & 4050.97     & 135.87    & 4050.97    & 1.0   & grb       \\
    1  & 200:20:0    & 1006.92 & 528.21      & 519.58    & 519.88     & 74.0  & admm\_msc \\
    0  & QPLIB\_1055 & 200.00  & 33.28       & 33.03     & 33.28      & 911.0 & grb       \\
    1  & QPLIB\_1055 & 200.58  & 33.05       & 33.04     & 33.04      & 231.0 & admm\_msc \\
    \bottomrule
  \end{tabular}
\end{frame}

\begin{frame}{Branch and cut}
  Introducing \(n\) auxiliary variables representing the bilinear terms, i.e., and we define the McCormick inequalities,
  \begin{align}
                       & x^Tx = \rho^Te, \rho_i = (x^2)_i     \\
    (\mathcal B) \quad & \rho \leq (u+l)\circ x_i - l \circ u \\
  \end{align}
  \begin{align}
    \model{MSC} \quad \mx\quad & y_0 ^T\lambda_0                    \\
    \st \quad                  & (y,z,x) \in \Omega                 \\
                               & y_i^Te \le s, \quad i=0, \cdots, m \\
                               & \rho^Te = s                        \\
                               & \rho \in \mathcal B
  \end{align}
\end{frame}
\begin{frame}{Branch and cut}
  Then we can obviously design a B-C framework based on the above.
  \begin{itemize}
    \item Since \(\rho^Te = s\) then it means the attainment of norm ``circles'', i.e., \(\|\xi\| = \|x\|\)
    \item Choice of branching on \(x\), find most violation \(\rho_i - \xi_i x_i\)
  \end{itemize}
\end{frame}
\begin{frame}
  \scriptsize
  \printbibliography
\end{frame}
\end{document}