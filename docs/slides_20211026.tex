\include{headers/header.slides}
\include{headers/cmd}
\usepackage{subfig}
\usepackage[style=authoryear]{biblatex}
\usepackage{bm}

\date{\today}
\addbibresource{headers/qcqp.bib}


\begin{document}
\fontsize{9pt}{11}\selectfont
\frame{\titlepage}
\begin{frame}{QCQP}
  Recall QCQP:

  \begin{equation}
    \begin{aligned}
      \mathrm{Maximize}\quad & x^TQx + q^T x                                   \\
      \mathrm{s.t.}  \quad   & x^{T} A_i x  + a_i^Tx   \; (\le, =, \ge) \; b_i \\
                             & 0\le x\le e
    \end{aligned}
  \end{equation}
\end{frame}
\begin{frame}{Problems to MSC}
  Recall in our quadratic constraints, \(A_i = V_i \diag (\lambda_i) V_i^T\), and in MSC we use,\begin{equation}
    z_i = V_i^Tx, y_i \ge z_i \circ z_i
  \end{equation}
  \begin{itemize}
    \item For MSC, \(z_i = V_i^Tx\), if \(V_i\) is not full rank, \(\|z_i\| \le \|x\|\)
    \item So that \(y_i^Te \ge \|z_i\|^2\), the truth is \(y_i^Te = \|z_i\|^2 (\textsf{ideally}) \le \|x\|\)
    \item Even if \(V_i, \forall i = 1, ..., m\),
          \begin{equation}
            y_i = z_i \circ z_i y_i^Te = \|x\|^2
          \end{equation}
  \end{itemize}
\end{frame}
\begin{frame}{Convexification}
  Convexify Q constraints,
  \begin{equation}\label{eq:primal.Sigma}
    \begin{aligned}
       & x^T(Q_i+t_i I_n) x+q_i^T x \leqslant b_i+ t_i \cdot s,i= 1,\dots, m \\
       & x^T x= s^2
    \end{aligned}
  \end{equation}
\end{frame}
\begin{frame}{MSC on the surface of norm balls}
  Optimal conditions for MSC,
  \begin{itemize}
    \item if \((y^*)^Te = \|x^*\|^2\), then \((x^*, y^*)\) is the solution
    \item we notice \(y_i^Te \ge \|z_i\|^2 = \|x\|^2 \) is guaranteed.
    \item we want to have,
          \[y_i^Te \le \|x\|^2\]
          which is clearly nonconvex
  \end{itemize}
\end{frame}
\begin{frame}{Norm-constrained MSC (NMSC)}
  Notice,
  \begin{equation}
    \|x\|^2 = \max_{\|\xi\| \le \sqrt s} \xi^T x
  \end{equation}
  So we add slack variable \(s, t, \xi\) and bilinear constraint.
  \begin{align}
    \model{MSC} \quad \mx\quad & y_0 ^T\lambda_0                     \\
    \st \quad                  & (y,z,x) \in \Omega                  \\
                               & y_i^Te \le t       & i=0, \cdots, m \\
    (\kappa) \quad             & t= s               & i=0, \cdots, m \\
    (\mu)    \quad             & \xi^Tx = t                          \\
                               & \xi^T\xi \le s
  \end{align}
  If \(s, t, \xi, y, z, x\) is the solution, then \( y, z, x\) is the optimal solution for MSC.
\end{frame}
\begin{frame}{NMSC: the ADMM approach}
  This allows the augmented Lagrangian function,

  \begin{align*}
    \mathscr L\left(x,y,z,\xi,s,\kappa,\mu\right) & = - y_0 ^T\lambda_0 + \kappa(t-s) + \mu(\xi^Tx - t) + \frac{\rho}{2}(t-s)^2 + \frac{\rho}{2}(\xi^Tx - s)^2
  \end{align*}

  The ADMM iteration,

  \begin{align*}
    (x,y,z,t)^{k+1} & = {\arg\min}_{(x,y,z)\in\Omega, t\ge 0} L\left(x,y,z,\xi^k,s^k,\kappa^k,\mu^k\right)       \\
    (s, \xi)^{k+1}  & = {\arg\min}_{(s, \xi)\in\mathscr{Q}} L\left((x,y,z,t)^{k+1},\xi,s, \kappa^k, \mu^k\right) \\
    \kappa^{k+1}    & = \kappa^k + \rho\left(t^{k+1}-s^{k+1}\right)                                              \\
    \mu^{k+1}       & = \mu^k + \rho\left( \langle\xi^{k+1}, x^{k+1}\rangle - s^{k+1}\right)
  \end{align*}
  where \(\mathscr{Q(\cdot)}\) forms a simple SOCP for \(s, \xi\),
  \begin{equation}
    \mathscr{Q}(x) =\left\{(s,\xi): \|\xi\|^2 \le s\right\}
  \end{equation}
\end{frame}
\begin{frame}{Simple test on ADMM}
  \begin{tabular}{llrrrrrl}
    \toprule
    {} & $n$:$m$:id  & $t$     & best\_bound & best\_obj & relax\_obj & nodes & method    \\
    \midrule
    0  & 5:5:0       & 0.03    & 5.56        & 5.56      & 5.56       & 29.0  & grb       \\
    1  & 5:5:0       & 8.44    & 5.56        & 5.56      & 5.56       & 171.0 & admm\_msc \\
    0  & 50:20:0     & 200.00  & 189.34      & 87.69     & 189.34     & 839.0 & grb       \\
    1  & 50:20:0     & 200.04  & 123.06      & 122.99    & 123.00     & 248.0 & admm\_msc \\
    0  & 50:50:0     & 200.00  & 197.20      & 68.50     & 197.20     & 395.0 & grb       \\
    1  & 50:50:0     & 200.39  & 159.97      & 157.23    & 157.36     & 86.0  & admm\_msc \\
    0  & 100:20:0    & 400.00  & 777.92      & 90.51     & 777.92     & 65.0  & grb       \\
    1  & 100:20:0    & 402.83  & 385.68      & 383.19    & 383.28     & 130.0 & admm\_msc \\
    0  & 100:50:0    & 400.01  & 817.60      & 115.00    & 817.60     & 12.0  & grb       \\
    1  & 100:50:0    & 406.29  & 367.47      & 358.75    & 359.59     & 61.0  & admm\_msc \\
    0  & 200:5:0     & 1000.00 & 3205.11     & 111.11    & 3205.11    & 2.0   & grb       \\
    1  & 200:5:0     & 1002.45 & 519.80      & 519.37    & 519.38     & 375.0 & admm\_msc \\
    0  & 200:20:0    & 1000.01 & 4050.97     & 135.87    & 4050.97    & 1.0   & grb       \\
    1  & 200:20:0    & 1006.92 & 528.21      & 519.58    & 519.88     & 74.0  & admm\_msc \\
    0  & QPLIB\_1055 & 200.00  & 33.28       & 33.03     & 33.28      & 911.0 & grb       \\
    1  & QPLIB\_1055 & 200.58  & 33.05       & 33.04     & 33.04      & 231.0 & admm\_msc \\
    \bottomrule
  \end{tabular}
\end{frame}

\begin{frame}
  However, ADMM should produce a KKT point instead of a global optimum, maybe we can test this on very specific problems,
  for example, the SNL.
\end{frame}
\begin{frame}{B-C using NMSC}
  Introducing \(n\) auxiliary variables representing the bilinear terms, i.e., and we define the McCormick inequalities,
  \begin{align}
                         & \xi^Tx = \rho^Te, \rho_i = (\xi \cdot x)_i \\
    (\mathcal B_i) \quad & \rho \geq l_\xi x+l_x \xi - l_x l_\xi      \\
                         & \rho_i \geq u_\xi x+u_x \xi-u_{x} u_\xi    \\
                         & \rho_i \leq u_\xi x+l_x \xi-l_x u_\xi      \\
                         & \rho_i \leq u_x\xi +l_\xi x-u_x l_\xi
  \end{align}
  \begin{align}
    \model{MSC} \quad \mx\quad & y_0 ^T\lambda_0                               \\
    \st \quad                  & (y,z,x) \in \Omega                            \\
                               & y_i^Te \le s, \quad i=0, \cdots, m            \\
                               & \xi^T\xi \le s                                \\
                               & \rho^Te = s                                   \\
                               & \rho_j \in \mathcal B_j, \quad j=0, \cdots, n
  \end{align}
\end{frame}
\begin{frame}{B-C using NMSC}
  Then we can obviously design a B-C framework based on the above.
  \begin{itemize}
    \item[?] Since \(\rho^Te = s\) then it means the attainment of norm ``circles'', i.e., \(\|\xi\| = \|x\|\)
    \item[?] Choice of branching on \(x\), find most violation? \(\rho_i - \xi_i x_i\)
    \item see \linebreak
          1. Gupte, A., Ahmed, S., Cheon, M.S., Dey, S.: Solving mixed integer bilinear problems using MILP formulations. SIAM Journal on Optimization. 23, 721–744 (2013) \linebreak
          2. Fischetti, M., Monaci, M.: A branch-and-cut algorithm for mixed-integer bilinear programming. European Journal of Operational Research. 282, 506–514 (2020)

  \end{itemize}
\end{frame}
\begin{frame}
  \scriptsize
  \printbibliography
\end{frame}
\end{document}