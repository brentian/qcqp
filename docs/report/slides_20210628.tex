\include{headers/header.slides}
\usepackage{subfig}
\usepackage[style=authoryear]{biblatex}
\usepackage{bm}
\title{Global QCQP Solver}
\author{Chuwen}
\date{\today}
\addbibresource{headers/qcqp.bib}


\begin{document}
\fontsize{9pt}{10}\selectfont
\frame{\titlepage}



\begin{frame}{QCQP}

  Suppose we readily have a sparse pattern \(G(V, E)\) (and extension \(E\subseteq F\)) for \(Q\)

  We denote aggregated pattern if \(G(V, E)\) stands for all data matrices. \cite{fukuda_exploiting_2001}, \cite{zheng_chordal_2020}

  \(F = \bigcup_r C_r\), SD constraint \(Y \succeq 0\) is equivalent to,

  \[Y_{(i, i) \in C_r} \succeq 0, \quad \forall r\]

  Can be expressed as follows,

  \begin{equation}
    \begin{aligned}
       & E_r \in \mathbf R^{|C_r|\times n}     \\
       & (E_r)_{i,j}=\begin{cases}
        1,  \text { if } C_r(i)=j \\
        0,  \text { otherwise }
      \end{cases} \\
       & Y_r\equiv E_r Y E_r^T \succeq 0       \\
    \end{aligned}
  \end{equation}
\end{frame}

\begin{frame}{Sparse-SDP: SSDP}
  In QCQP, we have the SD constraint:
  \[Y - xx^T \succeq 0\]
  then any subprinciple matrix is also semidefinite,
  \begin{equation}
    \begin{aligned}
       & E_r (Y - x x^T) E_r^T \succeq 0
    \end{aligned}
  \end{equation}

  So we have the QCQP with \(r\) smaller SDP constraints.

  \[\begin{aligned}
      \mathrm{Maximize}\quad & Q \bullet Y + q^Tx                               \\
      \mathrm{s.t.} \quad    & \begin{bmatrix}E_r Y E_r^T & E_rx \\ (E_rx)^T & 1\end{bmatrix}   \succeq 0, \forall r \\
    \end{aligned}\]

  This formulation incorporates a lot of linear constraints for \(C_r \cap C_{r'}\)
\end{frame}

% \begin{frame}{SSDP: Improvement}
%   \[\begin{aligned}
%       \mathrm{Maximize}\quad & Q \bullet \left(\sum_r E_r^T Y E_r\right) + q^Tx \\
%       \mathrm{s.t.} \quad    & \begin{bmatrix} Y_r & E_rx \\ (E_rx)^T & 1\end{bmatrix}   \succeq 0, \forall r \\
%                              & \mathrm{diag}(Y_r) \le E_r x,  \forall r
%     \end{aligned}\]
% \end{frame}

\begin{frame}{Test 1: general case}
  Test on \texttt{Max-Cut} problems with block diagonal matrix (cliques with no intersection)
  \begin{itemize}
    \item \texttt{ssdp} is the above method
    \item set time limit to 50, \(^\star\) means it is bool_solved to optimal
  \end{itemize}

  \begin{tabular}{llrrl}
    \toprule
    {} & prob\_num & solve\_time & relax\_obj & method \\
    \midrule
    sparsity: 0.5                                      \\
    0  & 40:0:0    & 6.07        & 124.00     & grb    \\
    1  & 40:0:0    & 0.02        & 139.56     & shor   \\
    2  & 40:0:0    & 0.01        & 153.04     & emsc   \\
    3  & 40:0:0    & 0.74        & 139.56     & ssdp   \\
    \midrule
    sparsity: 0.2                                      \\
    0  & 40:0:0    & 0.21        & 126.07     & grb    \\
    1  & 40:0:0    & 0.02        & 130.43     & shor   \\
    2  & 40:0:0    & 0.01        & 143.80     & emsc   \\
    3  & 40:0:0    & 0.82        & 130.43     & ssdp   \\
    \bottomrule
  \end{tabular}

\end{frame}

\begin{frame}{Test 2: perfect diagonal blocks}
  Test on \texttt{Max-Cut} problems with block diagonal matrix (cliques with no intersection)
  \begin{itemize}
    \item \texttt{ssdp} is the above method
    \item with perfect blocks:
          \[
            Y = \left(\sum_r E_r^T Y E_r\right)
          \]
          mark as: \texttt{ssdp-sum}
  \end{itemize}

  \begin{tabular}{llrrl}
    \toprule
    {} & prob\_num & solve\_time & relax\_obj       & method   \\
    \midrule
    0  & 100:0:0   & 0.20        & 283.65\(^\star\) & grb      \\
    1  & 100:0:0   & 0.16        & 289.15           & shor     \\
    2  & 100:0:0   & 0.01        & 355.54           & emsc     \\
    3  & 100:0:0   & 0.28        & 289.15           & ssdp     \\
    4  & 100:0:0   & 0.02        & 289.15           & ssdp-sum \\
    \midrule
    0  & 200:0:0   & 9.21        & 445.93\(^\star\) & grb      \\
    1  & 200:0:0   & 0.74        & 500.42           & shor     \\
    2  & 200:0:0   & 0.02        & 638.95           & emsc     \\
    3  & 200:0:0   & 0.41        & 500.42           & ssdp     \\
    4  & 200:0:0   & 0.03        & 500.42           & ssdp-sum \\
    \bottomrule
  \end{tabular}
\end{frame}

\begin{frame}{Test 3: branch and cut}
  Here we disable cuts in Gurobi for fair comparison.
  \begin{tabular}{llrrrrrl}
    \toprule
    {} & prob\_num & solve\_time & best\_bound & best\_obj & relax\_obj      & nodes  & method \\
    \midrule
    0  & 30:0:0    & 1.24        & 77.00       & 77.00     & 77.00\(^\star\) & 1822.0 & grb    \\
    1  & 30:0:0    & 11.21       & 77.01       & 76.97     & 77.01           & 325.0  & ssdp   \\
    2  & 30:0:0    & 30.03       & 83.58       & 75.24     & 83.58           & 1135.0 & emsc   \\
    \bottomrule
  \end{tabular}

  Many improvements can be done to SSDP.
  \begin{itemize}
    \item[\(\checkmark\)] Decrease number of cliques. Currently, we greedily union some of the cliques:
          \[\begin{aligned}
               & \bigcup_k \tilde C_k = \bigcup_r C_r \\
               & \tilde C_k = \bigcup_{r\in S_k} C_r
            \end{aligned}  \]
          such that \(|\tilde C_k| \ge \delta \) for some choice of \(\delta\) and we minimize \(|C_k \bigcap C_{k'}|  \)
    \item[\(\times\)] At each node with pivot \(x_i\) only have to resolve the problem by few cliques (ideally), whenever
          \[i \in C_r, \forall r\]
  \end{itemize}
\end{frame}

\begin{frame}
  \scriptsize
  \printbibliography
\end{frame}

\end{document}