\documentclass[aspectratio=1610, 10pt]{beamer}
\usepackage[english]{babel}
\usepackage{amsmath, amsthm, subfiles, bm, hyperref, graphicx}
\usepackage{caption, longtable, booktabs}
% my cmd
%%%%%%%%%%%%%%%%
% start my commands
%%%%%%%%%%%%%%%%
\newcommand{\lm}{\lambda_\textrm{max}}
\newcommand{\trace}{\mathbf{trace}}
\newcommand{\diag}{\mathbf{diag}}
\newcommand{\model}[1]{(\textbf{#1})}
\newcommand{\mx}{\mathbf{\max}\;}
\newcommand{\mn}{\mathbf{\min}\;}
\newcommand{\st}{\mathrm{s.t.\;}}
\newcommand{\ex}{\mathbf E}
\newcommand{\dx}{\;\bm dx}
\newcommand{\pr}{\mathbf P}
\newcommand{\id}{\mathbf I}
\newcommand{\bp}{\mathbb P}
\newcommand{\be}{\mathbb E}
\newcommand{\bi}{\mathbb I}
\newcommand{\bxi}{{\bm \xi}}
\newcommand{\va}{\mathbf{Var}}
\newcommand{\dif}{\mathbf{d}}
\newcommand{\minp}[2]{\min\{#1, #2\}}
\newcommand{\intp}{\mathbf{int}}
\newcommand{\apex}{\mathbf{apex}}
\newcommand{\conv}{\mathbf{conv}}
\newcommand{\red}[1]{\textcolor{red}{#1}}
\usefonttheme[onlymath]{serif}

%%%%%%%%%%%%%%%%
% finish my commands
%%%%%%%%%%%%%%%%

% theorem environments
\setbeamertemplate{footline}[frame number]


\makeatletter
\patchcmd{\beamer@sectionintoc}
{\ifnum\beamer@tempcount>0}
{\ifnum\beamer@tempcount>-1}
{}
{}
\beamer@tocsectionnumber=0
\makeatother

% set the toc to be using the number
\setbeamertemplate{section in toc}[sections numbered]
\setbeamertemplate{subsection in toc}[subsections numbered]

\hypersetup{pdfstartview={Fit}}

\AtBeginSection[]
{
    \begin{frame}
        \frametitle{Table of Contents}
        \tableofcontents[        currentsection,         currentsubsection,         subsectionstyle=show/shaded/hide,]
    \end{frame}
}


\defbeamertemplate{section page}{mine}[1][]{%
    \begin{centering}
        \vskip1em\par
        \begin{beamercolorbox}[sep=12pt, center]{part title}
            \usebeamerfont{section title}\insertsection\par
        \end{beamercolorbox}
    \end{centering}
}

\defbeamertemplate{subsection page}{mine}[1][]
{
    \begingroup
    \begin{beamercolorbox}[sep=8pt, center]{subsection title}
        \usebeamerfont{subsection title}\insertsubsection\par
    \end{beamercolorbox}
    \endgroup
}


\setbeamertemplate{section page}[mine]
\setbeamertemplate{subsection page}[mine]

\begin{document}


\title{SOCP + SDP Relaxations for QCQP}

\author{
  Chuwen Zhang
}


\maketitle
\begin{frame}{The QCQP}
  We consider the QCQP,
  \begin{equation}
    \label{eq:inhoqcqp}
    \begin{aligned}
      \model{QCQP} \quad \mx \quad & x^T Qx + q^T x                                    \\
      \textrm{s.t.} \quad          & x^T A_i x + a_i^T x \hspace{0.27em} (\le, =, \ge)
      \hspace{0.27em} b_i                                                              \\
                                   & 0 \le x \le 1
    \end{aligned}
  \end{equation}
  For simplicity we first consider \(m = 0\), i.e.,
  \begin{equation}
    \label{eq:inhoqcqp.box}
    \begin{aligned}
      \model{QCQP} \quad \mx \quad & x^T Qx + q^T x \\
      \textrm{s.t.} \quad          & 0 \le x \le 1
    \end{aligned}
  \end{equation}
\end{frame}
\begin{frame}[allowframebreaks]{Motivation}
  \begin{itemize}
    \item Pure SOCP cones are hard to improve, as we tried \cite{bienstock_cutting-planes_2014}, convexification via aggregations \cite{burer_how_2017}, etc.
    \item size of SDP cone scales in \(O(n^2)\)
    \item we seek a \red{mixture of both}
  \end{itemize}
\end{frame}
\begin{frame}[allowframebreaks]{Some Related Schemes to Mix SOCP or Small SDP Cones}
  Now assume we use second-order cones. Lifted matrix \(X \succeq 0\) is allowed.

  \textbf{Method 1}, Relaxing PSD constraint on \(X\): \cite{kim_exact_2003}, for each \((k, j)\) in sparsity pattern \((k, j) \in \Lambda\),
  \begin{equation*}
    (X_{k j})^{2} \leq X_{k k} X_{j j}
  \end{equation*}

  \textbf{Method 1.1}, Extension of 1. \cite{kocuk_matrix_2018}, use matrix minors, ensure \(2\times 2\) submatrices are singular.


  \textbf{Method 1.1}, Chordal graphs. \cite{fukuda_exploiting_2001}

\end{frame}

\begin{frame}[allowframebreaks]{A Simple Mixed Cone Scheme}
  We partition \(Q\) into a \(n\times n\) matrix, \(Q_0\) plus a set of small matrices \(\{Q_c\}_{c \in \mathcal C}\)

  Assume,
  \begin{equation*}
    x^TQx = x^TQ_0x + \sum_c x_c^TQ_cx_c
  \end{equation*}

  where \(c \in \mathcal C\) is a subset of index \([n]\)

  \begin{enumerate}
    \item for example, we have a large \(Q_0\) and a small \(2\times 2\) matrix \(Q_1\),
          \begin{equation*}
            x^T Q x = x^T \begin{bmatrix}
              q_{11}  &        & q_{1 j} &        & q_{1 i} &        &         \\
                      & \ddots &         &        &         &        &         \\
              q_{j 1} &        & 0       &        & 0       &        &         \\
                      &        &         & \ddots &         &        &         \\
              q_{i 1} &        & 0       &        & 0       &        &         \\
                      &        &         &        &         & \ddots &         \\
                      &        &         &        &         &        & q_{n n}
            \end{bmatrix} x + Q_1 \bullet X_1
          \end{equation*}

          \framebreak
    \item similarly, for \(\mathcal C\) of size larger than 1. We can sequentially construct a set of small cones, a simple scheme at iteration \(k\): \(Q^{(k+1)}_0 = Q^{(k)}_0 - Q_c^{(k)}\)
          \begin{align*}
            x^TQx & = x^TQ_0x + \sum_c Q_c \bullet X_c \\
            X_c   & \succeq x_c x_c^T
          \end{align*}
    \item possible to adopt more sophisticated summation by cones of dimension \(\ge 2\)
  \end{enumerate}
\end{frame}

\begin{frame}[allowframebreaks]{Small test on mixed cones: SOCP + \(2\times 2\) matrices}
  \begin{enumerate}
    \item We implement a simple branch and cut, original problem has the constraint,
          \begin{align*}
            x\circ x \le \rho
          \end{align*}
    \item At each time we find a critical edge \((i, j)\) that has the greatest residual, \(\rho^* - x^* \circ x^*\)
    \item Then rewrite the objective constraint by updating \(Q_0\) and \(\{Q_c\}\)
  \end{enumerate}
  \small
  \begin{longtable}{llrrrrrl}
    \toprule
    {} & prob\_num & solve\_time & best\_bound & best\_obj & relax\_obj & nodes & method          \\
    \midrule
    0  & 6:0:0     & 0.00        & 15.12       & 15.12     & 15.12      & 1.0   & grb             \\
    1  & 6:0:0     & 0.48        & 15.13       & 15.12     & 15.13      & 49.0  & bb\_nmsc        \\
    2  & 6:0:0     & 0.74        & 15.13       & 15.12     & 15.13      & 43.0  & \red{bb\_msocp} \\
    0  & 15:0:0    & 0.01        & 66.06       & 66.06     & 66.06      & 1.0   & grb             \\
    1  & 15:0:0    & 7.01        & 66.07       & 66.06     & 66.07      & 489.0 & bb\_nmsc        \\
    2  & 15:0:0    & 20.42       & 66.07       & 66.06     & 66.07      & 653.0 & \red{bb\_msocp} \\
    0  & 15:0:0    & 0.02        & 27.28       & 27.28     & 27.28      & 1.0   & grb             \\
    1  & 15:0:0    & 5.71        & 27.30       & 27.28     & 27.30      & 397.0 & bb\_nmsc        \\
    2  & 15:0:0    & 9.18        & 27.29       & 27.28     & 27.29      & 321.0 & \red{bb\_msocp} \\
    \bottomrule
  \end{longtable}
  \normalsize
\end{frame}


\begin{frame}[allowframebreaks]{Questions \& Future Work: Partition Scheme}

  Recall we partition \(x^TQx\) ``online'' in the bb tree.

  Consider some special cases in the form,

  \begin{align*}
    Q                                & = Q' - Q_0                       \\
    \text{SOC} \quad   y             & \ge \|R_0^Tx\|^2, R_0R_0^T = Q_0 \\
    \text{SD} \quad   \max_{x} x^TQx & = \max_{x, X} Q'\bullet X - y
  \end{align*}

  Assume \(Q', A'_i\) are in a good family.
  In max problem, \(\text{SOC}\) is tight.

  \begin{enumerate}
    \item \(Q'\) that is: 1. ``good'' for SDP relaxation; 2. make \(Q_0 \succeq 0\); 3. achieve more sparsity.
    \item \(Q'\) is diagonal, tested in box constraint (\red{not tight}), \underline{should work in sphere}?
  \end{enumerate}


\end{frame}
\begin{frame}[allowframebreaks]{Bibliography}
  \bibliography{headers/qcqp}
  \bibliographystyle{apalike}
\end{frame}
\end{document}
