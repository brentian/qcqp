\documentclass[aspectratio=1610, 10pt]{beamer}
\usepackage[english]{babel}
\usepackage{amsmath, amsthm, subfiles, bm, hyperref, graphicx}
% my cmd
%%%%%%%%%%%%%%%%
% start my commands
%%%%%%%%%%%%%%%%
\newcommand{\lm}{\lambda_\textrm{max}}
\newcommand{\trace}{\mathbf{trace}}
\newcommand{\diag}{\mathbf{diag}}
\newcommand{\model}[1]{(\textbf{#1})}
\newcommand{\mx}{\mathbf{\max}\;}
\newcommand{\mn}{\mathbf{\min}\;}
\newcommand{\st}{\mathrm{s.t.\;}}
\newcommand{\ex}{\mathbf E}
\newcommand{\dx}{\;\bm dx}
\newcommand{\pr}{\mathbf P}
\newcommand{\id}{\mathbf I}
\newcommand{\bp}{\mathbb P}
\newcommand{\be}{\mathbb E}
\newcommand{\bi}{\mathbb I}
\newcommand{\bxi}{{\bm \xi}}
\newcommand{\va}{\mathbf{Var}}
\newcommand{\dif}{\mathbf{d}}
\newcommand{\minp}[2]{\min\{#1, #2\}}
\newcommand{\intp}{\mathbf{int}}
\newcommand{\apex}{\mathbf{apex}}
\newcommand{\conv}{\mathbf{conv}}
\newcommand{\red}[1]{\textcolor{red}{#1}}
\usefonttheme[onlymath]{serif}

%%%%%%%%%%%%%%%%
% finish my commands
%%%%%%%%%%%%%%%%

% theorem environments
\setbeamertemplate{footline}[frame number]


\makeatletter
\patchcmd{\beamer@sectionintoc}
{\ifnum\beamer@tempcount>0}
{\ifnum\beamer@tempcount>-1}
{}
{}
\beamer@tocsectionnumber=0
\makeatother

% set the toc to be using the number
\setbeamertemplate{section in toc}[sections numbered]
\setbeamertemplate{subsection in toc}[subsections numbered]

\hypersetup{pdfstartview={Fit}}

\AtBeginSection[]
{
    \begin{frame}
        \frametitle{Table of Contents}
        \tableofcontents[        currentsection,         currentsubsection,         subsectionstyle=show/shaded/hide,]
    \end{frame}
}


\defbeamertemplate{section page}{mine}[1][]{%
    \begin{centering}
        \vskip1em\par
        \begin{beamercolorbox}[sep=12pt, center]{part title}
            \usebeamerfont{section title}\insertsection\par
        \end{beamercolorbox}
    \end{centering}
}

\defbeamertemplate{subsection page}{mine}[1][]
{
    \begingroup
    \begin{beamercolorbox}[sep=8pt, center]{subsection title}
        \usebeamerfont{subsection title}\insertsubsection\par
    \end{beamercolorbox}
    \endgroup
}


\setbeamertemplate{section page}[mine]
\setbeamertemplate{subsection page}[mine]

\begin{document}


\title{SOCP Relaxations for QCQP}

\author{
  Chuwen Zhang
}


\maketitle

\section{More understandings for SOCP relaxations}

\begin{frame}{The QCQP}
  We consider the QCQP,
  \begin{equation}
    \label{eq:inhoqcqp}
    \begin{aligned}
      \model{QCQP} \quad \mx \quad & x^T Qx + q^T x                                    \\
      \textrm{s.t.} \quad          & x^T A_i x + a_i^T x \hspace{0.27em} (\le, =, \ge)
      \hspace{0.27em} b_i                                                              \\
                                   & 0 \le x \le 1
    \end{aligned}
  \end{equation}
  For simplicity we first consider \(m = 0\), i.e.,
  \begin{equation}
    \label{eq:inhoqcqp.box}
    \begin{aligned}
      \model{QCQP} \quad \mx \quad & x^T Qx + q^T x \\
      \textrm{s.t.} \quad          & 0 \le x \le 1
    \end{aligned}
  \end{equation}
\end{frame}
\begin{frame}[allowframebreaks]{Convex Relaxations with SOCP}
  Now assume we use second-order cones. No lifted matrix \(X \succeq 0\) is allowed.

  \textbf{Method 1}, \textcolor{red}{(MSC)} Many-small-cones, based on diagonalization, then we approximate on 1-D quadratic functions that form the many but smaller (actually 2D) smaller cones.
  Use Spectral decomposition, if \(Q = V\Gamma V^T\), then assume \(V\) is full rank, the nonconvexity moves to the norm constraints.
  \begin{equation}\label{eq:primal.msc}
    \begin{aligned}
       & V_i^Tx = z_i,i= 1,\dots, m                     \\
       & y_i = z_i \circ z_i \Rightarrow y^Te = \|x\|^2
    \end{aligned}
  \end{equation}

  \textbf{Method 2}, \textcolor{red}{(Scaling)} For any indefinite quadratic matrix, scale by identity matrices.
  \begin{equation}\label{eq:primal.scale}
    \begin{aligned}
       & x^T(Q_i+ \textcolor{red}{t_i I_n}) x+ q_i^T x \leq b_i+ \textcolor{red}{t_i \cdot s},i= 1,\dots, m \\
       & \|x\|^2= s
    \end{aligned}
  \end{equation}

  Then bound \(s\) as whole or let \(\sum_i \rho_i = s\) and bound \(\rho\) separately.
  \framebreak

  \textbf{More Complex...} Use D.C., i.e., \(Q = Q_+ - Q_-\) where two parts a negative semi-definite (for max problem) or psd (for min problem).
  Since it is a max problem, let,
  \begin{align*}
    \dagger\;  & z \le \textcolor{red}{\rho} - x^TQ_-x + q^Tx \\
    \ddagger\; & \red{\rho} \le x^TQ_+x                       \\
  \end{align*}
  Then naturally we can at least come up with two convexification,
  \begin{enumerate}
    \item As before, let \((x-l)^T(x-u) \le 0\) to convexify \(\ddagger\), equivalent to compute \(\lambda_{\max}(Q_+)\), this would be equivalent to \red{Scaling} and \red{MSC}
    \item Use \(\dagger\) to convexify \(\ddagger\). i.e., find \(\alpha\), such that,
          \begin{equation*}
            \alpha \cdot Q_- - Q_+ \succeq 0
          \end{equation*}
  \end{enumerate}

  \framebreak
  \textbf{Summary}
  \begin{enumerate}
    \item All mentioned above can be viewed as construction of convex hull of two quadratic sets. And can be covered by the scheme in \cite{burer_how_2017}
    \item Can also be interpreted from the cutting plane scheme by \cite{bienstock_cutting-planes_2014}. For example, in the D.C.,
          \begin{align*}
            \dagger\;  & z \le \textcolor{red}{\rho} - x^TQ_-x + q^Tx \\
            \ddagger\; & \red{\rho} \le x^TQ_+x                       \\
          \end{align*}
          it views \(\ddagger\) as reverse convex set of the paraboloid.
          \begin{equation}
            \ddagger\; \Leftrightarrow \{x: x\in \mathbb R^n - P\}, P = \{(x, \rho) : x^TQ_+x \le \rho\}
          \end{equation}

          \framebreak

          At each solution it cuts off \((\bar x, \bar \rho) \in P\) by a linear inequality.
          Lift a first order underestimation,
          \begin{align*}
            (\dagger)\; \rho - z & \ge \left(2Q_-\bar x - q\right)^T(x-\bar x) + \bar x^TQ_-\bar x - q^Tx, \forall \bar x \\
            \textbf{Lifting: } \dagger                                                                                    \\
            \rho - z             & \ge \bar{x}^{T} Q_- \bar{x} - q^{T} \bar{x}
            +\left(
            \begin{bmatrix} 2Q_-\bar x - q \\ 0 \end{bmatrix} - \alpha
            \begin{bmatrix} 2Q_+ \bar{x} \\ -1 \end{bmatrix}
            \right)^{T}\begin{bmatrix}
              x-\bar{x} \\
              \bar\rho-\bar{x}^{T} Q_+ \bar{x}
            \end{bmatrix}                                                                         \\
          \end{align*}
          Theorem 4.13, \cite{bienstock_cutting-planes_2014}. \(\alpha^\star = 1/\lambda_{\max} (Q_+)\), then lifting inequality is the tightest.

          This can be seen as supporting hyperplanes for the convex hull of \(\dagger, \ddagger\). \red{If we already convexify and deploy the SOCP to it, the cutting planes will be useless.}
  \end{enumerate}

  \textbf{In conclusion}, the different schemes are actually equivalent, in different views of 1. convex hull by aggregation, 2. cutting plane to reverse convex set.
  \framebreak

\end{frame}

\begin{frame}[allowframebreaks]{Convexification with the Box Constraint}
  For a box \(x \in [l, u]\), any RLT inequality can be constructed by a doubly nonnegative matrix \(B, B \succeq 0, B \ge 0\), such that,
  \begin{equation*}
    (x-l)^TB(x-u) \le 0
  \end{equation*}
  \begin{enumerate}
    \item to convexify \(\rightarrow\) solve \(\alpha\)
          \begin{align*}
                                  & x^TAx + a^Tx + b\le 0                 \\
            \Leftrightarrow \quad & \{\alpha >0: \alpha B + A \succeq 0\}
          \end{align*}
    \item if \(B= I_n\), it is equivalent to scaling, other choices \(B= Q_-\) do not have much improvements
    \item in MSC, we do not need extra RLTs, since we have \((x_i - l_i)(x_i - u_i) \le 0\) for each \(i\)
  \end{enumerate}
\end{frame}

\begin{frame}{Questions}

  \begin{itemize}
    \item \textbf{RLT} can we do \((x_i - l_i)(x_j - u_j) \le 0\)
    \item for a general optimization model,
          \begin{align*}
                                & f(x), \;  \st  x \in S, S \text{ compact}                      \\
            \Rightarrow ? \quad & \mx z, \; \st (x, z) \in \conv (S \cap \{(x, z): z \le f(x)\})
          \end{align*}
    \item strengthen by \cite{ye_new_2003} ?
          \begin{align*}
                        & a^Tx \le b, \|x\| \le \sqrt\delta,                     \\
            \Rightarrow & \|(b - a^Tx)x\| = \|bx - Xa\| \le \sqrt\delta (b-a^Tx)
          \end{align*}
  \end{itemize}
\end{frame}
\begin{frame}{Future Work}
  \begin{enumerate}
    \item Refine recent findings into Branch-and-Cut
    \item Incorporate nonlinear intersection cut
    \item Local method to find a feasible solution
  \end{enumerate}
\end{frame}
\begin{frame}[allowframebreaks]{Bibliography}
  \bibliography{headers/qcqp}
  \bibliographystyle{alpha}
\end{frame}
\end{document}
