\documentclass[aspectratio=1610, 10pt]{beamer}
\usepackage[english]{babel}
\usepackage{amsmath, amsthm, subfiles, bm, hyperref, graphicx}
\usepackage{mathrsfs}
\usepackage{caption, longtable, booktabs}
\usepackage{cancel}

% my cmd
%%%%%%%%%%%%%%%%
% start my commands
%%%%%%%%%%%%%%%%
\newcommand{\lm}{\lambda_\textrm{max}}
\newcommand{\trace}{\mathbf{trace}}
\newcommand{\diag}{\mathbf{diag}}
\newcommand{\model}[1]{(\textbf{#1})}
\newcommand{\mx}{\mathbf{\max}\;}
\newcommand{\mn}{\mathbf{\min}\;}
\newcommand{\st}{\mathrm{s.t.\;}}
\newcommand{\ex}{\mathbf E}
\newcommand{\dx}{\;\bm dx}
\newcommand{\pr}{\mathbf P}
\newcommand{\id}{\mathbf I}
\newcommand{\bp}{\mathbb P}
\newcommand{\be}{\mathbb E}
\newcommand{\bi}{\mathbb I}
\newcommand{\bxi}{{\bm \xi}}
\newcommand{\va}{\mathbf{Var}}
\newcommand{\dif}{\mathbf{d}}
\newcommand{\minp}[2]{\min\{#1, #2\}}
\newcommand{\intp}{\mathbf{int}}
\newcommand{\apex}{\mathbf{apex}}
\newcommand{\conv}{\mathbf{conv}}
\newcommand{\red}[1]{\textcolor{red}{#1}}
\usefonttheme[onlymath]{serif}

%%%%%%%%%%%%%%%%
% finish my commands
%%%%%%%%%%%%%%%%

% theorem environments
\setbeamertemplate{footline}[frame number]


\makeatletter
\patchcmd{\beamer@sectionintoc}
{\ifnum\beamer@tempcount>0}
{\ifnum\beamer@tempcount>-1}
{}
{}
\beamer@tocsectionnumber=0
\makeatother

% set the toc to be using the number
\setbeamertemplate{section in toc}[sections numbered]
\setbeamertemplate{subsection in toc}[subsections numbered]

\hypersetup{pdfstartview={Fit}}

\AtBeginSection[]
{
    \begin{frame}
        \frametitle{Table of Contents}
        \tableofcontents[        currentsection,         currentsubsection,         subsectionstyle=show/shaded/hide,]
    \end{frame}
}


\defbeamertemplate{section page}{mine}[1][]{%
    \begin{centering}
        \vskip1em\par
        \begin{beamercolorbox}[sep=12pt, center]{part title}
            \usebeamerfont{section title}\insertsection\par
        \end{beamercolorbox}
    \end{centering}
}

\defbeamertemplate{subsection page}{mine}[1][]
{
    \begingroup
    \begin{beamercolorbox}[sep=8pt, center]{subsection title}
        \usebeamerfont{subsection title}\insertsubsection\par
    \end{beamercolorbox}
    \endgroup
}


\setbeamertemplate{section page}[mine]
\setbeamertemplate{subsection page}[mine]

\begin{document}


\title{QCQP: Progress Report}

\author{
  Chuwen Zhang
}


\maketitle
\begin{frame}{The QCQP}
  We consider the QCQPï¼Œ
  \begin{equation}
    \label{eq:inhoqcqp}
    \begin{aligned}
      \model{QCQP} \quad \mx \quad & x^T Qx + q^T x                                        \\
      \textrm{s.t.} \quad          & x^T A_i x + a_i^T x \hspace{0.27em} (\le, =, \ge) b_i \\
    \end{aligned}
  \end{equation}
\end{frame}
\begin{frame}[allowframebreaks]{Rank-\(r\) Indefiniteness}

  Formally, a quadratic inequality induced by a symmetric matrix \(A\) can be expressed as the following,

  \begin{equation}
    x^T \left(\sum_{j\in J_+} \lambda_j v_jv_j^T\right)x +a^Tx \le b + \left(\sum_{j\in J_-} \lambda_j v_jv_j^T\right)
  \end{equation}

  \begin{itemize}
    \item For clarity, we say a quadratic inequality by \(A_i\) is \emph{rank-\(r\) indefinite} if first \(r\) eigenvalues are negative.
    \item In comparison, a maximization problem with matrix \(Q\) is rank-\(r\) indefinite if last \(r\) eigenvalues are nonnegative.
  \end{itemize}

\end{frame}
\begin{frame}[allowframebreaks]{Rank-\(1\) Indefinite Quadratic Inequality}
  Suppose \(Q = RR^T - aa^T\)

  For quadratic inquality,  it can be written as,

  \begin{equation*}
    x^TRR^Tx \le (a^Tx)^2
  \end{equation*}

  Then we natually solve the problem in two disjoint subregions, by \(a^Tx \ge 0 \vee  a^Tx \le 0 \),
  \begin{align*}
    (P1) \quad & \|R^Tx\| \le - a^Tx \\
    (P2) \quad & \|R^Tx\| \le a^Tx
  \end{align*}

  Implementation,
  \begin{itemize}
    \item Create offline subregions at depth 0 (multiple root nodes)
    \item \red{Seems} impossible to do explicit disjunctions for inhomogeneous case.
    \item Apply branch and bound.
  \end{itemize}

\end{frame}
\begin{frame}[allowframebreaks]{Rank-\(1\) Indefinite Maximization}
  Consider maximization
  \begin{align*}
    \max \quad             & x^T(aa^T-RR^T)x + q^Tx           \\
    \Rightarrow \max \quad & z                                \\
    \st \quad              & z + x^TRR^Tx - q^Tx \le (a^Tx)^2
  \end{align*}

  We analyze,
  \begin{equation*}
    S = \{(z, x): x^TRR^Tx + z - q^Tx \le (a^Tx)^2\}
  \end{equation*}

  \begin{enumerate}
    \item Simply branch on \(sign(a^Tx)\) will prune one region very fast by bound.
    \item \red{Seems} impossible to do explicit disjunctions as homogeneous inequality.
    \item If using \red{best bound} rule in node selection, it has no obvious advantage.
    \item Apply branch and bound.
  \end{enumerate}
  \framebreak
\end{frame}
\begin{frame}[allowframebreaks]{Extension to rank-\(r\)}

  Consider quadratic maximization,
  \begin{equation}\label{eq:qp_unc_rr_conic}
    \begin{aligned}
      \mx \quad & z                                                                                  \\
      \st \quad & \sum_{j \in J_{-}} \lambda_{j} z_j - q^T x+z \le  \sum_{j \in J_{+}} \lambda_j z_j \\
                & y_j \ge (x_j^T v_j)^2, j= 1, ..., n
    \end{aligned}
  \end{equation}

  With box or ball as regularity (else \eqref{eq:qp_unc_rr_conic} will be unbounded.)
  \begin{itemize}
    \item ball: \(x\in B(0, \delta)\), \(x\in [0, 1]^n\)
    \item ellipsoid: \(x \in \{x: x^TAx + a^Tx \le \delta^2\}\)
    \item regularity implies, (explains why ball constraint is easier.)
          \begin{equation}
            y^Te = \|x\|^2
          \end{equation}
  \end{itemize}
\end{frame}

\begin{frame}[allowframebreaks]{Computational Results}
  \begin{itemize}
    \item We test on ``unconstrained'' (with only a box or ball on \(x\))
    \item MSC is very effective in the test problems. as \(r \nearrow \), the problem becomes hard.
    \item MSC is tight with only ball constraints? (TRS)
  \end{itemize}
\end{frame}

\begin{frame}[allowframebreaks]{Future Work}
  \begin{itemize}
    \item Extension to an indefinite quadratic inequalities
    \item Plug in ADMM as primal feasible solution.
  \end{itemize}
\end{frame}

\begin{frame}[allowframebreaks]{Future Work: Multiple Quadratic Constraints}
  Our old MSC.
  \begin{align}
    \nonumber \mathrm{Maximize}\quad & y_0 ^T\lambda_0 + q^Tx                         \\
    \mathrm{s.t.} \quad              & V_i z_i = x                        & i=0,...,m \\
                                     & y_i ^T\lambda_i  + a_i^Tx  \le b_i & i=1,...,m \\
    \label{quad}                     & y_i = z_i \circ z_i                & i=0,...,m
  \end{align}
  \begin{itemize}
    \item In this formulation, we need \(m \times n\) auxillary pairs \((z, y)\) by allowing different bases \(V_i\)
    \item Actually this may not be necessary...
  \end{itemize}

  \framebreak
  Consider one indefinite \(A\) with a rank-\(r\) indefinite \(Q\), we can convexify \(A\) by\dots
  \begin{align*}
    Q = \sum_{J_+} \lambda_j v_jv_j^T - \sum_{J_-} \lambda_j v_jv_j^T
  \end{align*}
  \begin{eqnarray}
    & x^TA_+ x - x^TA-x + a^Tx \le b \\
    \Rightarrow \quad & x^T\left(A + V_-\red{\Gamma}V^T_-\right )x +a^Tx \le b + \underbrace{x^T(V_-\red{\Gamma}V^T_-)x}_{\diag(\Gamma)^Ty}
  \end{eqnarray}
  \begin{itemize}
    \item Then we do not need to add more \(\{y\}\) for this constraint.
    \item The only question left is whether we can find \(\Gamma\) such that,
          \begin{equation}
            V_-\red{\Gamma}V^T_- - A_- \succeq 0
          \end{equation}
    \item This is weaker than simultaneous diagonalization via congruence.
  \end{itemize}
\end{frame}
\begin{frame}[allowframebreaks]{Future Work: ADMM in the original \(x\)}

  Notice,
  \begin{equation}
    \|x\|^2 = \max_{\|\xi\| \le \sqrt s} \xi^T x
  \end{equation}
  So we add slack variable \(s, t, \xi\) and bilinear constraint.
  \begin{align}
    \model{MSC} \quad \mathrm{Maximize: }\quad & y_0 ^T\lambda_0                     \\
    \mathrm{s.t.} \quad                        & (y,z,x) \in \Omega                  \\
                                               & y_i^Te \le t       & i=0, \cdots, m \\
    (\kappa) \quad                             & t= s               & i=0, \cdots, m \\
    (\mu)    \quad                             & \xi^Tx = t                          \\
                                               & \xi^T\xi \le s
  \end{align}
  If \(s, t, \xi, y, z, x\) is the solution, then \( y, z, x\) is the optimal solution for MSC.

  This allows the augmented Lagrangian function,

  \begin{align*}
    \mathscr L\left(x,y,z,\xi,s,\kappa,\mu\right) & = - y_0 ^T\lambda_0 + \kappa(t-s) + \mu(\xi^Tx - t) + \frac{\rho}{2}(t-s)^2 + \frac{\rho}{2}(\xi^Tx - s)^2
  \end{align*}

  The ADMM iteration,

  \begin{align*}
    (x,y,z,t)^{k+1} & = {\arg\min}_{(x,y,z)\in\Omega, t\ge 0} L\left(x,y,z,\xi^k,s^k,\kappa^k,\mu^k\right)       \\
    (s, \xi)^{k+1}  & = {\arg\min}_{(s, \xi)\in\mathscr{Q}} L\left((x,y,z,t)^{k+1},\xi,s, \kappa^k, \mu^k\right) \\
    \kappa^{k+1}    & = \kappa^k + \rho\left(t^{k+1}-s^{k+1}\right)                                              \\
    \mu^{k+1}       & = \mu^k + \rho\left( \langle\xi^{k+1}, x^{k+1}\rangle - s^{k+1}\right)
  \end{align*}
  where \(\mathscr{Q(\cdot)}\) forms a simple SOCP for \(s, \xi\),
  \begin{equation}
    \mathscr{Q}(x) =\left\{(s,\xi): \|\xi\|^2 \le s\right\}
  \end{equation}

  \framebreak

  The size of auxillary variable \(\xi\) equals to \(n\), if \(r\) is small,

  We can actually shrink the size of above problem.
  \begin{align}
    \model{MSC} \quad \mathrm{Maximize: }\quad & y_0 ^T\lambda_0                                       \\
    \mathrm{s.t.} \quad                        & (y,z,x) \in \Omega                                    \\
                                               & y_i^Te = s                           & i=0, \cdots, m \\
    ( \mu_i, i\in I_+ )    \quad               & \xi_i \cdot (v_i^Tx) = y_i           & \red{i\in I_+} \\
                                               & \xi_i^2 \le y_i,  (v_i^Tx)^2 \le y_i
  \end{align}
  The ADMM,

  \begin{equation}
    \mathcal L = y^T\lambda + \sum_{i \in I_+} \mu_i \left [\xi_i \cdot(v_i^Tx) - y_i\right] + \frac{\rho}{2}\sum_{i \in I_+} (\xi_i \cdot (v_i^Tx) - y_i)^2
  \end{equation}

  Which is easier than old ADMM for general case.

\end{frame}



%%%%%%%%%%%%%%%
% appendix
%%%%%%%%%%%%%%%
% \begin{frame}[allowframebreaks]{Attempt for explicit disjunctions for inhomogeneous case}
%   \textbf{Alternatively}: branching on \(z - q^Tx\).

%   \textbf{Case I}: if \(z - q^Tx \le 0\), then,
%   \begin{align*}
%                                            & x^TRR^Tx - \underbrace{(q^Tx - z)}_{\Delta \ge 0} = (a^Tx)^2 \\
%     \text{Let: }\beta \ge 1 \Rightarrow \; & \red{\beta}\cdot \Delta\ge \|R^Tx\|^2                        \\
%     \Rightarrow \;                         & \red{(\beta - 1)}\cdot\Delta \ge (a^Tx)^2
%   \end{align*}

%   Can be rewritten as two rotated cones,
%   \begin{align*}
%     \beta + \Delta     & \ge \left\|\begin{array}{c} 2R^Tx \\ \beta - \Delta \end{array}\right\| \\
%     \beta - 1 + \Delta & \ge \left\|\begin{array}{c} 2a^Tx \\ \beta - 1 - \Delta \end{array}\right\| \\
%   \end{align*}
%   \framebreak

%   \textbf{Case II}: if \(z - q^Tx \ge 0\),

%   \begin{align*}
%     x^TRR^Tx +     & \underbrace{(z - q^Tx)}_{\Delta \ge 0} = (a^Tx)^2      \\
%                    & x^TRR^Tx + \red{\cancel{\Delta}} \le (a^Tx)^2          \\
%     \Rightarrow \; & \underbrace{a^Tx \ge \|R^Tx\|}_{\textsf{subcase II.1}}
%     \vee \underbrace{- a^Tx \ge \|R^Tx\|}_{\textsf{subcase II.2}}           \\
%   \end{align*}


%   This creates unbalanced subregions (same situation before.)

%   \framebreak

%   Try something similar to \textbf{Case I}

%   \begin{align*}
%     \beta \ge 1 \Rightarrow \; & \red{\beta}\cdot\Delta \ge (a^Tx)^2       \\
%                                & \red{(\beta - 1)}\cdot\Delta \ge (R^Tx)^2 \\
%                                & \red{\beta} \ge 1
%   \end{align*}

%   \(\Delta \doteq z - q^Tx\) is not bounded from above (we are maximizing \(z\))


%   \begin{align*}
%     \rho            & \ge (a^Tx)^2 \quad \dagger \\
%     \rho  -  \Delta & \ge \|R^Tx\|^2             \\
%   \end{align*}

%   \(\rho\) is not bounded from above \(\dagger\) will not be tight.
%   So the branch and bound is implemented on \(a^Tx \)
%   % Then we branch by last solution \(\rho^*\)
%   % \begin{equation*}
%   %   a^Tx \le \sqrt{\rho^*} \vee a^Tx \le \sqrt{\rho^*}
%   % \end{equation*}

% \end{frame}


% \begin{frame}[allowframebreaks]{Bibliography}
%   \bibliography{headers/qcqp}
%   \bibliographystyle{apalike}
% \end{frame}
\end{document}
