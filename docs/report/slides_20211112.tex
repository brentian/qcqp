\include{headers/header.slides}
\include{headers/cmd}
\usepackage{subfig}
\usepackage[style=authoryear]{biblatex}
\usepackage{bm}

\date{\today}
\addbibresource{headers/qcqp.bib}


\begin{document}
\fontsize{9pt}{11}\selectfont
\frame{\titlepage}
\begin{frame}{QCQP}
  Recall QCQP:

  \begin{equation}
    \begin{aligned}
      \mathrm{Maximize}\quad & x^TQx + q^T x                                   \\
      \mathrm{s.t.}  \quad   & x^{T} A_i x  + a_i^Tx   \; (\le, =, \ge) \; b_i \\
                             & 0\le x\le e
    \end{aligned}
  \end{equation}

  \begin{itemize}
    \item \(Q, A_i\) maybe indefinite
  \end{itemize}
\end{frame}
\begin{frame}{Convex Relaxations with SOCP}
  Now assume we are using a suitable relaxation, we choose second-order cones. No lifted matrix \(X \in \mathscr{S}^n\) is allowed.
  \begin{itemize}
    \item Method 1, \textcolor{red}{(MSC)} Many-small-cones, based on spectral decomposition, then we approximate on 1-D quadratic functions that form the many but smaller (actually 2D) smaller cones. Use Spectral decomposition, if \(Q = V\Gamma V^T\), then assume \(V\) is full rank, the approximation actually reduces to the following hard constraints,
          \begin{equation}\label{eq:primal.msc}
            \begin{aligned}
               & V_i^Tx = z_i,i= 1,\dots, m                     \\
               & y_i = z_i \circ z_i \Rightarrow y^Te = \|x\|^2
            \end{aligned}
          \end{equation}
    \item Method 2, scale \(Q, A_i\) to be positive/negative semi-definite, then do convex relaxation based on Cholesky \(Q +\lambda I_n = RR^T\), method 2 is simply,
          \begin{equation}\label{eq:primal.scale}
            \begin{aligned}
               & x^T(Q_i+t_i I_n) x+q_i^T x \leqslant b_i+ t_i \cdot s,i= 1,\dots, m \\
               & \|x\|^2= s
            \end{aligned}
          \end{equation}
    \item DC, use some \(Q = Q_+ - Q_-\) where two parts a negative semi-definite (for max problem) or psd (for min problem).
  \end{itemize}
\end{frame}
\begin{frame}{Current progress}
  We see these methods are, not too surprisingly, the same, and they suffer the identical difficulties. In essence, we wish to solve a convex optimization problem subject to the norm sphere: \(n\)-dimensional \(\|x\|^2 = s\) or equivalently \(x_i^2 = \rho_i\)
  \begin{itemize}
    \item if we are have,
          \begin{equation*}
            x^Tx \le s, i.e., \begin{bmatrix}
              1/2 \\ s\\ x
            \end{bmatrix} \in \mathscr{Q}
          \end{equation*}
          we only need the reverse inequality,
          \begin{equation*}
            x^Tx \ge s
          \end{equation*}
    \item (B-C) intuitively solved by RLT like inequalities. readily plugged into current B-C framework. Need research on new cutting planes.
          \begin{align}
                               & x^Tx = \rho^Te, \rho_i = (x^2)_i     \\
            (\mathcal B) \quad & \rho \leq (u+l)\circ x_i - l \circ u
          \end{align}
    \item (ADMM) or use a local method, maybe useful to feasibility problem, like kissing \#
  \end{itemize}
\end{frame}
\begin{frame}{ADMM, the ALM}
  Notice,
  \begin{equation}
    \|x\|^2 = \max_{\|\xi\| \le \sqrt s} \xi^T x
  \end{equation}
  So we add slack variable \(s, t, \xi\) and bilinear constraint.
  \begin{align}
    \model{MSC} \quad \mathrm{Maximize: }\quad & y_0 ^T\lambda_0                     \\
    \mathrm{s.t.} \quad                        & (y,z,x) \in \Omega                  \\
                                               & y_i^Te \le t       & i=0, \cdots, m \\
    (\kappa) \quad                             & t= s               & i=0, \cdots, m \\
    (\mu)    \quad                             & \xi^Tx = t                          \\
                                               & \xi^T\xi \le s
  \end{align}
  If \(s, t, \xi, y, z, x\) is the solution, then \( y, z, x\) is the solution for MSC.
  This allows the augmented Lagrangian function,

  \begin{align*}
    \mathscr L\left(x,y,z,\xi,s,\kappa,\mu\right) & = - y_0 ^T\lambda_0 + \kappa(t-s) + \mu(\xi^Tx - t) + \frac{\rho}{2}(t-s)^2 + \frac{\rho}{2}(\xi^Tx - s)^2
  \end{align*}
\end{frame}
\begin{frame}{ADMM, iteration}
  The ADMM iteration,

  \begin{align*}
    (x,y,z,t)^{k+1} & = {\arg\min}_{(x,y,z)\in\Omega, t\ge 0} L\left(x,y,z,\xi^k,s^k,\kappa^k,\mu^k\right)       \\
    (s, \xi)^{k+1}  & = {\arg\min}_{(s, \xi)\in\mathscr{Q}} L\left((x,y,z,t)^{k+1},\xi,s, \kappa^k, \mu^k\right) \\
    \kappa^{k+1}    & = \kappa^k + \rho\left(t^{k+1}-s^{k+1}\right)                                              \\
    \mu^{k+1}       & = \mu^k + \rho\left( \langle\xi^{k+1}, x^{k+1}\rangle - s^{k+1}\right)
  \end{align*}
  where \(\mathscr{Q(\cdot)}\) forms a simple SOCP for \(s, \xi\),
  \begin{equation}
    \mathscr{Q}(x) =\left\{(s,\xi): \|\xi\|^2 \le s\right\}
  \end{equation}
\end{frame}

\begin{frame}{ADMM, kissing \#}
  for balls in \(R^d\), let \(X \in R^{n\times d}\), use the following formulation,
  \begin{align*}
    \| x_i - x_j \| \ge 4 \Rightarrow\; & \|x_i + x_j\|^2 \le s \le 12                                         \\
                                        & \| x_i \| \le 2                                                      \\
                                        & \| \xi_i \| \le 2                                                    \\
    (\mu)\;                             & x_i ^T \xi_i = 4                                                     \\
    \mathcal L = \;                     & \sum_i \mu_i (x_i ^T \xi_i - 4 ) + \rho \sum_i (x_i ^T \xi_i - 4 )^2
  \end{align*}
  This is not convergent! Refine this into a local method.
\end{frame}

\begin{frame}{Cutting planes for QCQP}
  \textbf{S-free sets}
  \begin{itemize}
    \item Gonzalo Mu√±oz, '20, '21, IPCO, Maximal quadratic free sets and intersection cuts. keywords: S-free sets, the reverse of nonconvex S is convex, find maximal \(C \in R^n - S\), in QCQP, use LP relaxation, extreme rays to create intersection cuts.
    \item Bienstock, outer-product-free sets. '20
  \end{itemize}
  \textbf{Convex hulls for some special structure, SOCPr (SOCP-representable)}
  \begin{itemize}
    \item Convexify some nonconvex quadratic regions. e.g., Burer '17, quadratic function with one negative eigenvalue (norm balls) intersection with almost any quadratic function (ellipsoid, paraboloids, hyperbolic paraboloid, hyperboloid)
    \item Modaresi, Vielma' 17, Convex hull of two quadratic or a conic quadratic and a quadratic inequality
    \item Santana, Dey' 20, The Convex Hull of a Quadratic Constraint over a Polytope
    \item Dey et al' 19, New SOCP relaxation and branching rule for bipartite bilinear programs
  \end{itemize}
  \textbf{Linear disjunction}
\end{frame}
\begin{frame}{Burer '17}
  For intersection with a paraboloid and quadratic function (indefinite)
  \begin{align*}
    \mathcal Y         = \quad  & \left\{y=\left(\begin{array}{c}
        \tilde{y} \\
        y_{n}
      \end{array}\right) \in R ^{n}: \begin{array}{c}
      \tilde{y}^{T} \tilde{y} \leq y_{n} \\
      \tilde{y}^{T} \tilde{Q} \tilde{y}+2 g^{T} y+f \leq 0
    \end{array}\right\}                      \\
    \textrm{Homogenize: } \quad & x = [\tilde y, y_n, x_{n+1}]                                                                                         \\
                                & A_{0}:=\begin{bmatrix}
      I     & 0            & 0            \\
      0^{T} & 0            & -\frac{1}{2} \\
      0^{T} & -\frac{1}{2} & 0
    \end{bmatrix}, \quad A_{1}:=\begin{bmatrix}
      \tilde{Q}     & 0     & \tilde{g} \\
      0^{T}         & 0     & g_{n}     \\
      \tilde{g}^{T} & g_{n} & f
    \end{bmatrix}, \quad H^{1}:=\left\{x: x_{n+1}=1\right\} \\
    \textrm{Def} \quad          & A_{t}:=\begin{bmatrix}
      (1-t) I+t \tilde{Q} & 0                                      & t \tilde{g}                            \\
      0^{T}               & 0                                      & (1-t)\left(-\frac{1}{2}\right)+t g_{n} \\
      t \tilde{g}^{T}     & (1-t)\left(-\frac{1}{2}\right)+t g_{n} & t f
    \end{bmatrix}                                                                                    \\
                                & t = 1 /(1-\lambda), \lambda = \min(\lambda(Q)) < 0                                                                   \\
    \mathcal Y_t = \quad        & \left\{y : \tilde{y}^{T} \tilde{y} \leq y_{n}, x^TA_t x \le 0 \right\}                                               \\
    \Rightarrow \quad           & \mathcal Y_t = \textrm{cl.convex.hull}( \mathcal Y)
  \end{align*}
\end{frame}
\begin{frame}{Cutting planes for QCQP}
  \begin{itemize}
    \item use SOCPr to improve QCQP relaxations
    \item consider cases for box constraint (so as to incorporate Branch and Cut)
  \end{itemize}
\end{frame}
\end{document}